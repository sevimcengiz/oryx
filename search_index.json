[["index.html", "Oryx-MRSI Documentation Chapter 1 Oryx-MRSI", " Oryx-MRSI Documentation Sevim Cengiz, Muhammed Yildirim, Abdullah Bas, Esin Ozturk Isik 2021-05-10 Chapter 1 Oryx-MRSI Oryx-MRSI is a fully automated software for a comprehensive analysis of multi-slice proton magnetic resonance spectroscopic imaging (1H-MRSI) data. Prerequirements MATLAB R2020b FSL for FLIRT SPM12 GUI Layout Toolbox Widgets Toolbox Oryx-MRSI is tested on MAC (2.9 GHz Quad-Core Intel Core i7, 16 GB 2133 MHz LPDDR3, Radeon Pro 560 4 GB Intel HD Graphics 630 1536 MB ) and Ubuntu 18.04.4 LTS (Memory 32GIB, Processor Intel Core i7-9800X CPU (3.8GHzx16?), Graphics GeForce RTX 2070/PCle/SSE2) "],["intro.html", "Chapter 2 Introduction 2.1 Oryx-MRSI 2.2 Release 2.3 Licencing 2.4 Developers 2.5 Acknowledgements", " Chapter 2 Introduction 2.1 Oryx-MRSI Oryx-MRSI is a fully automated software for a comprehensive analysis of multi-slice proton magnetic resonance spectroscopic imaging (1H-MRSI) data. Oryx-MRSI functionality includes chemical shift correction, segmentation, tissue fraction calculation, metabolite maps generation, registration of metabolite maps onto MNI152 brain atlas, and ROI analysis for metabolite concentration and ratio estimation at different brain parcellations. Oryx-MRSI Github Repository Link Oryx-MRSI was programmed in MATLAB 2020a (The Mathworks Inc., Natick, MA).The software asks for some parameters before the data analysis.The user needs to provide parameters for the multi-slice 1H-MRSI data. Required parameters: Exclusion criteria for fCSF, SNR, FWHM, CRLB RF bandwidhth of the system for chemical shift correction Cut-off value for the probabilistic binary map after registration Chemical shift correction is On or Off RFOV dir is RL or AP Chemical shift dir (AP) is A or P Chemical shift dir (LR) is L or R Chemical shift dir (FH) is F or H Reference metabolite Load Data Reads the raw 1H-MRSI data and LCModel .coord otput files for raw data and Coord file visualization of spectra. Co-registration Coregisters FOV,Press-Box(VOI), all voxels of spectra considering chemical shift correction if chemical shift correction is ‘On.’ Segmentation Calculation of WM, GM, CSF fractions in each voxel of all metabolites considering chemical shift correction. FWHM-SNR Visualization of FWHM and SNR values for all voxels. Spectral Quality Visualization of included voxels into the 1H-MRSI data analysis after exclusion criteria values considering FWHM, SNR, CRLB, and fCSF. Metabolite Map All metabolite results are used to create metabolite maps including: concentration map, concentration map to Ins ratio, concentration map to Cr+PCr ratio, CSF corrected concentration map, CSF corrected concentration map to Ins ratio, CSF corrected concentration map to Cr+PCr ratio. Registration Generates MNI152 brain atlas-Registered metabolite maps including the outputs created in the previous module. ROI Analysis Region of interest (ROI) analysis at multiple brain atlases like Schafer2018 100/400 Parcels on 7 resting-state (rs-fMRI) networks or MNI thr 0/25/50 brain regions. 2.2 Release Version 1.0 2.3 Licencing MIT License 2.4 Developers Sevim Cengiz Muhammed Yildirim Abdullah Bas Esin Ozturk Isik Should you publish material that made use of Oryx-MRSI, please cite the following publication: Cengiz S, Yildirim M, Bas A, Ozturk-Isik E. ORYX-MRSI: A data analysis software for multi-slice 1H-MRSI. International Society for Magnetic Resonance in Medicine. Virtual Meeting, May 15-20, 2021. (Digital Poster) 2.5 Acknowledgements This project was funded by TUBITAK 115S219. We thank all open-source MR and MRS tools. Oryx-MRSI uses some functions of FID-A, check this link for licence. Oryx-MRSI uses some functions of Gannet. Edden RAE, Puts NAJ, Harris AD, Barker PB, Evans CJ. Gannet: A batch-processing tool for the quantitative analysis of gamma-aminobutyric acid-edited MR spectroscopy spectra. J. Magn. Reson. Imaging 2014;40:1445–1452. doi: 10.1002/jmri.24478) Oryx-MRSI uses some functions of Osprey, check this link for licence. G Oeltzschner, HJ Zöllner, SCN Hui, M Mikkelsen, MG Saleh, S Tapper, RAE Edden. Osprey: Open-Source Processing, Reconstruction &amp; Estimation of Magnetic Resonance Spectroscopy Data. J Neurosci Meth 343:108827 (2020). Oryx-MRSI uses some functions of MRS_MRI_libs, check this link for license. Oryx-MRSI uses some functions of NIFTI-Matlab, check this link for licence. Oryx-MRSI uses some functions written by Jamie Near (McGill University) Oryx-MRSI uses some functions written by H.Ratiney (CREATIS-LRMN) Oryx-MRSI uses Schaefer2018_100/400Parcels_7Networks_order_FSLMNI152_2mm.nii. See Github link, for licence. Oryx-MRSI uses MNI152_T1_2mm_brain.nii.gz, MNI-maxprob-thr0/25/50-2mm.nii.gz acquired from FSL, for licence. If there is any function that I forget to mention about name/link/citation, please let me know. "],["getting-started.html", "Chapter 3 Getting started 3.1 Requirements 3.2 Install Oryx-MRSI 3.3 Before Use Oryx-MRSI 3.4 How to organize your raw data", " Chapter 3 Getting started 3.1 Requirements MATLAB R2020b FSL for FLIRT SPM12 GUI Layout Toolbox Widgets Toolbox Oryx-MRSI is tested on MAC (2.9 GHz Quad-Core Intel Core i7, 16 GB 2133 MHz LPDDR3, Radeon Pro 560 4 GB Intel HD Graphics 630 1536 MB ) and Ubuntu 18.04.4 LTS (Memory 32GIB, Processor Intel Core i7-9800X CPU (3.8GHzx16?), Graphics GeForce RTX 2070/PCle/SSE2) 3.2 Install Oryx-MRSI Oryx-MRSI uses FSL-Flirt function so using FSL from MATLAB should be ready. If you want to install FSL into your computer, check this link If you use MAC, check this link (Advance Usage part-Using FSL from MATLAB) If you use LINUX, check this link (Using FSL from MATLAB) Plase download SPM12 using this link Please, check Oryx-MRSI Github Repository. Please, clone the repository, or download. 3.3 Before Use Oryx-MRSI Add the entire Oryx-MRSI directory (with subfolders) to your MATLAB path. Add the entire SPM12 directory (with subfolders) to your MATLAB path. Please make sure that FSL usage from Matlab command window installation is completed properly. Before running a data analysis using Oryx-MRSI, let’s check that FSL usage is from Matlab is done. Please open matlab and run check_fsl_usage_from_matlab.m script which is given under Oryx-MRSI Github repo. % FSL usage from Matlab command window installation check % If this script gives an error, please go to this website and make sure % that you have complete fsl-installation properly. % If you use MAC, check this link : https://fsl.fmrib.ox.ac.uk/fsl/fslwiki/FslInstallation/MacOsX (Advance Usage part-Using FSL from MATLAB) % If you use LINUX, check this link : % https://fsl.fmrib.ox.ac.uk/fsl/fslwiki/FslInstallation/Linux (Using FSL % from MATLAB) function check_fsl_usage_from_matlab() currentFolder = pwd; datapath=[currentFolder, filesep, &#39;Dataset&#39;,filesep,&#39;K_01&#39;,filesep,&#39;exam_1&#39;,filesep,&#39;images&#39;,filesep,&#39;T1&#39;, filesep,&#39;nifti&#39;,filesep,&#39;K_01.nii.gz&#39;]; outputpath=[currentFolder, filesep, &#39;Dataset&#39;,filesep,&#39;K_01&#39;,filesep,&#39;exam_1&#39;,filesep,&#39;images&#39;,filesep,&#39;T1&#39;, filesep,&#39;nifti&#39;,filesep,&#39;K_01_Bet.nii.gz&#39;]; sprintf(&#39;FSL usage from matlab is checking by using FSL BET&#39;); system([&#39;bet &#39;,datapath,&#39; &#39;,outputpath,&#39; -m -f 0.35&#39;]); sprintf(&#39;FSL usage from matlab is working.&#39;); end %%% For MacOsX, it might be helpful. Copied from https://fsl.fmrib.ox.ac.uk/fsl/fslwiki/FslInstallation/MacOsX (Advance Usage part-Using FSL from MATLAB) % If you have installed FSL somewhere % other than /usr/local/fsl/, change % this first line accordingly. %fsldir = &#39;/usr/local/fsl/; %fsldirmpath = sprintf(&#39;%s/etc/matlab&#39;,fsldir); %setenv(&#39;FSLDIR&#39;, fsldir); %setenv(&#39;FSLOUTPUTTYPE&#39;, &#39;NIFTI_GZ&#39;); %path(path, fsldirmpath); %clear fsldir fsldirmpath; If there is no error, FSL usage from Matlab is completely installed. If you get an error, plese check these: If you use MAC, check this link (Advance Usage part-Using FSL from MATLAB) If you use LINUX, check this link (Using FSL from MATLAB) 3.4 How to organize your raw data If you want to go through with your own data set, the folder of data structure given below will help you. There is a dataset folder under Oryx-MRSI. Each patient should be listed under that folder. Each patient should have T1w-MRI, T2w-MRI or both. If you have T1w-MRI: ~/Oryx-MRSI/Dataset/PatientName/exam_1/images/T1/nifti/PatientName_Bet.nii.gz If you have T2w-MRI: ~/Oryx-MRSI/Dataset/PatientName/exam_1/images/T2/nifti/PatientName_Bet.nii.gz You need .sdat&amp;.spar data and LCModel outputs. For spectra: ~/Oryx-MRSI/Dataset/PatientName/exam_1/spectra/PatientName_press_1_raw_act.sdat ~/Oryx-MRSI/Dataset/PatientName/exam_1/spectra/PatientName_press_1_raw_act.spar ~/Oryx-MRSI/Dataset/PatientName/exam_1/spectra/PatientName_press_1_raw_ref.sdat ~/Oryx-MRSI/Dataset/PatientName/exam_1/spectra/PatientName_press_1_raw_ref.spar For LCModel outputs at press_1: ~/Oryx-MRSI/Dataset/PatientName/exam_1/spectra/lcmodel_outputs/PatientName_press_1_raw_act/ - Each folder has to have .coord and .table files. They need to be named as: **PatientName**_press_1_raw_act_sl1_4-7.coord (It shows slice 1, row 4, column 7) **PatientName**_press_1_raw_act_sl1_4-7.table (It shows slice 1, row 4, column 7) "],["oryx-mrsi-gui-tutorial.html", "Chapter 4 Oryx-MRSI GUI Tutorial 4.1 Starting Oryx-MRSI 4.2 Load Module 4.3 Co-registration Module 4.4 Segmentation Module 4.5 FWHM &amp; SNR Module 4.6 Spectral Quality Module 4.7 Metabolite Map Module 4.8 Registration Module 4.9 ROI Analysis", " Chapter 4 Oryx-MRSI GUI Tutorial This tutorial describes each step of the Oryx-MRSI analysis using the graphical user interface. We will learn how to start the GUI, select the spar file, select requirements information an the Main Gui Page and then Oryx-MRSI will enable us to use 8 different modules. 4.1 Starting Oryx-MRSI Please, make sure that SPM12 and ORYX-MRSI folders in the addpath with subfolders. (For more information, see this) Please, make sure that FSL command can be used via Matlab and run check_fsl_usage_from_matlab.m (For more information, see this) Let’s start with Oryx-MRSI. At the MATLAB prompt, enter &gt;&gt;&gt; Oryx It will display the Oryx-MRSI main Page. Selecting data and providing information. Click the select .spar file button ,and open dataset folder under Oryx-MRSI repository in your drive. Choose an example dataset or select your own dataset (Please, follow the steps at here link). Provide information for MRSI acquisition after T1w-MRI or T2w-MRI. Provide information for the chemical shift correction. (Recommended is ON if you have the system RF bandwidths information) If chemical shift correction is on, please provide information shown in the figure. Please, select reference metabolite for chemical shift correction. Please, provide cut-off values for automated spectral quality. Please, provide cut-off value for the probabilistic binary map after MNI152 brain atlas registration. Please, click Done button. Done 4.2 Load Module This module reads the raw 1H-MRSI data, LCModel .coord output files, and allows for a visualization of the spectra. Click, for the magnification of the selected spectra. 4.3 Co-registration Module If chemical shift correction is ON, then the chemical shift misregistration amount is calculated for each metabolite using the selected metabolite as the reference and RF pulse bandwidths for each direction provided on the Main Page. Then, a metabolic map is shifted into its respective location considering the MR image space data order. Afterwards, the field of view (FOV), the PRESS box, and each voxel within the FOV are co-registered onto anatomical MR image for each metabolite map followed by the visualization of the shifted metabolite maps. 4.4 Segmentation Module After white matter (WM), gray matter (GM), and cerebrospinal fluid (CSF) are segmented from a T1-weighted MRI using SPM12, the module calculates the WM, GM and CSF fractions (fWM, fGM, and fCSF) in each voxel for every metabolite, which vary due to chemical shift misregistration.Figure shows the fCSF, fWM and fGM maps for a selected metabolite (NAA+NAAG) at one slice. This part might take 30 minutes. 4.5 FWHM &amp; SNR Module This module reads LCModel .table files to get FWHM and SNR values of each voxel to create and visualize multivoxel FWHM and SNR maps. 4.6 Spectral Quality Module This module displays voxels included in the 1H-MRSI data analysis for each metabolite after the FWHM, SNR, CRLB, and fCSF exclusion criteria defined on the Main Page are applied. 4.7 Metabolite Map Module The LCModel .table files are parsed using a text reader and each metabolite result is positioned into a 3D grid in accordance with the MR image space data to create several maps, which are the concentration, CSF corrected concentration (C=C0*(1/(1-fCSF))), and concentration or CSF corrected concentration to Ins and Cr+PCr ratio maps. Currently, these maps are created for nine different metabolites, which are Cr+PCr, Glu+Gln, GPC+PCh, Ins, Lac, Lip13a, Lip13b, Lip13a+Lip13b. 4.8 Registration Module This modules registers the reference anatomical MRI onto MNI152 brain atlas using FMRIB’s Linear Image Registration Tool (FSL FLIRT) to obtain a transformation matrix. Then, this transformation matrix is used to register the PRESS box and all the concentration or ratio maps that were previously co-registered to the anatomical MRI onto the MNI152 brain atlas. The user provides a cutoff value for the probabilistic maps, (at the main page), which are produced as a result of registration, and all the pixels that exceed this threshold are included in the data analysis. 4.9 ROI Analysis The metabolic maps are currently evaluated at different brain regions to define a mean, median and standard deviation value of the concentration map of interest at these brain regions. A result is produced for a parcellation if only more than provided value at the ROI Analyze page% of its pixels are included within the metabolite map of interest. "],["output-files.html", "Chapter 5 Output Files", " Chapter 5 Output Files A folder named nifti will be created after the analysis. It includes all spectral volumes. FSLeyes link is suggested for nifti file visualization. A folder named outputs will include all excell files after ROI Analysis. "]]
